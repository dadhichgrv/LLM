from langchain.schema import Document
from langchain_community.vectorstores import FAISS
from langchain.retrievers.multi_query import MultiQueryRetriever

all_documents = [
        Document(
            page_content="Rising global temperatures due to greenhouse gas emissions pose significant threats to ecosystems and human settlements worldwide.",
            metadata={"topic": "global warming", "doc_id": "doc1"}
        ),
        Document(
            page_content="Eating green vegetables is good for balanced diet",
            metadata={"topic": "global warming", "doc_id": "doc2"}
        ),
        Document(
            page_content="Regular physical activity combined with balanced nutrition significantly reduces the risk of cardiovascular disease and improves mental wellbeing.",
            metadata={"topic": "health and lifestyle", "doc_id": "doc3"}
        ),
        Document(
            page_content="Mindfulness practices and adequate sleep are essential components of stress management in today's fast-paced digital environment.",
            metadata={"topic": "health and lifestyle", "doc_id": "doc4"}
        ),
        Document(
            page_content="The solar energy system in homes keeps balanced electricity demand",
            metadata={"topic": "health and lifestyle", "doc_id": "doc5"}
        )
]


faiss_index = FAISS.from_documents(all_documents, embeddings)
         

multiquery_retriever = MultiQueryRetriever.from_llm(
                                         llm=client, 
                                         retriever = faiss_index.as_retriever(search_type="mmr",
                                                                              search_kwargs={"k":4})
                                         )    


result_multiquery = multiquery_retriever.invoke("How to stay healthy")

print("\n Result for multi query \n")
for i, doc in enumerate(result_multiquery):
  print("Result ",i+1)
  print(doc.page_content)
